<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper   PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="login">


	<resultMap type="adminUserVO" id="adminUserMap">
		<result column="seq" 		property="seq" />
		<result column="id" 		property="id" />
		<result column="name" 		property="name" />
		<result column="position" 		property="position" />
		<result column="tel" 		property="tel" />
		<result column="email" 		property="email" />
		<result column="cellphone" 		property="cellphone" />
		<result column="auth_level" property="authLevel" />
	</resultMap>
	
	<resultMap type="adminUserVO" id="adminUserDetMap" extends="adminUserMap">
		<result column="auth" 		property="auth" />
		<result column="pw" 		property="pw" />
	</resultMap>
	
 	<select id="selectAdminLogin" parameterType="adminUserVO" resultMap="adminUserDetMap">
	 	SELECT
	 		SEQ as seq 
	 		, CUL_ID as id
	 		, CUL_PASSWORD as pw
	 		, CUL_NAME as name
	 		, CUL_AUTH as auth
	 		, CUL_AUTH_LEVEL as authLevel
	 		, LOGIN_FAIL as failCnt
	 		, POSITION as position
	 		, CREATION_USER
	 		, CREATION_DATE
	 		, LASTUPDATE_USER
	 		, LASTUPDATE_DATE
	 	FROM CO_Culture
	 	WHERE CUL_ID = #{id}
	 	AND CUL_PASSWORD = #{pw}

 	</select>

 	<select id="selectAdminLoginCheck" parameterType="hashmap" resultType="int">
	 	select count(CUL_ID) from CO_Culture
	 	where CUL_ID = #{id}
	 	and CUL_PASSWORD = #{pw}

 	</select>
 	 	
 	<update id="updatePassword" parameterType="hashmap">
	
		UPDATE CO_Culture
		SET			 
<!-- 	   		  pwd = password(#{chg_pwd}) -->
	   		  CUL_PASSWORD = #{chg_pwd}
	   		, LASTUPDATE_USER = #{id}
	   		, LASTUPDATE_DATE = now()	
	   	WHERE CUL_ID = #{id}
	   		AND CUL_PASSWORD = #{cur_pwd}
<!-- 	   		AND pwd = password(#{cur_pwd}) -->
	
	</update> 	
 	
	 	
</mapper>
